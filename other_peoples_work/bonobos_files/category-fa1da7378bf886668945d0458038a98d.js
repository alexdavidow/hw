/* a global object for bonobos stuff */
window.Bnbs={supportsLocalStorage:function(){try{return"localStorage"in window&&window.localStorage!==null}catch(e){return!1}}},function(e){function t(){e("ul.products-grid").each(function(t){var n=0;e("ul#products-grid-"+t+" li .productGrid-description").each(function(t){e(this).height()>n&&(n=e(this).height())}),e("ul#products-grid-"+t+" li .productGrid-description").css("height",n+"px")})}function n(){e(".close-lightbox-overlay").die("click"),e("#lb-overlay").removeClass("close-lightbox-overlay");var t=0,n=0,r=e(window).height()/2;r=Math.round(r);var i=document.body.scrollTop;i==0&&(window.pageYOffset?i=window.pageYOffset:i=document.body.parentElement?document.body.parentElement.scrollTop:0),r+=i,e("#lb-canvas").css("top",r+"px"),e("#lb-loaderIcon").css("top",r+"px"),e("#lb-overlay").queue(function(){e("#lb-overlay").css("height",e(document).height()+"px"),e("#lb-overlay").css("width","100%"),e("#lb-overlay").css("left",0),e("#lb-overlay").css("display","block"),e("#lb-loaderIcon").css("display","block"),e(this).dequeue()})}function r(){negativeLeftMargin=e("#lb-canvas-content").outerWidth(),negativeLeftMargin/=2,negativeTopMargin=e("#lb-canvas-content").outerHeight(),negativeTopMargin+=63,negativeTopMargin/=2,e("#lb-loaderIcon").css("display","none"),e("#lb-canvas").css("margin-left","-"+negativeLeftMargin+"px"),e("#lb-canvas").css("margin-top","-"+negativeTopMargin+"px"),e("#lb-canvas").css("left","50%"),e("#lb-overlay").addClass("close-lightbox-overlay"),e(".close-lightbox-overlay").live("click",function(){e("#lb-canvas").css("left","-3000px"),e("#lb-canvas #lb-canvas-content").html(""),e("#lb-overlay").hide()})}function i(t){n(),e("#lb-canvas-content").append('<img src="'+t+'" border="0" id="enlarged-image" />'),e("#enlarged-image").load(function(){r()})}function s(t,i){n(),e("#lb-canvas-content").html(t),r(),lbLoadedForm=new VarienForm(i,!1)}e.fn.extendAs=function(t,n){return this.each(function(){var r=e(this),i=r.data(t),s=typeof n=="object"&&n;i||r.data(t,i=new Bnbs[t](r,s)),typeof n=="string"&&i[n]()})},Bnbs.ImgSwitcher=function(e,t){this.init(e,t)},Bnbs.ImgSwitcher.prototype={constructor:Bnbs.ImgSwitcher,init:function(t,n){this.$clickSwitchee=t.find(n.clickSwitchee),this.$hoverSwitchee=t.find(n.hoverSwitchee),this.$switcher=t.find(n.switcher).click(e.proxy(this.activate,this)).on("mouseenter",e.proxy(this.hover,this)).on("mouseleave",e.proxy(this.hover,this)),this.$switcher.parent().find(".default").trigger("click")},activate:function(t){var n=e(t.currentTarget),r=n.attr("id");this.$switcher.removeClass("active"),n.trigger("mouseleave").addClass("active"),this.$clickSwitchee.removeClass(this.activeId).addClass(r),this.activeId=r},hover:function(t){var n=e(t.currentTarget);if(!n.hasClass("active")){var r=n.attr("id");t.type==="mouseenter"?(this.hoverId=r,this.$hoverSwitchee.addClass(this.hoverId)):this.$hoverSwitchee.removeClass(this.hoverId)}}},Bnbs.LightboxGallery=function(e,t){this.init(e,t)},Bnbs.LightboxGallery.prototype={constructor:Bnbs.LightboxGallery,init:function(t,n){this.galleryId=n.galleryId,this.$thumbs=t.find(n.thumbs),this.$thumbs.find("a").click(e.proxy(this.open,this)),this.$main=t.find(n.main).click({isMain:!0},e.proxy(this.open,this)),this.$gallery=e('<div id="'+this.galleryId+'" class="lightbox-gallery">'+this.$thumbs.html()+"</div>").prependTo(document.body),this.mainThumbIdx=t.find(".main-view-thumb").index()||0},attachKeyboard:function(){this.galleria.attachKeyboard({left:this.galleria.prev,right:this.galleria.next,escape:e.proxy(this.close,this)})},open:function(t){t.preventDefault();var n=t.data&&t.data.isMain?this.mainThumbIdx:e(t.currentTarget).index();this.$backdrop?this.$backdrop.show():this.$backdrop=e('<div class="ui-block"/>').appendTo(document.body).click(e.proxy(this.close,this)),this.$gallery.show();if(this.galleria)this.galleria.show(n),this.attachKeyboard();else{var r=this;Galleria.run("#"+this.galleryId,{show:n}).ready(function(){r.galleria=r.$gallery.data("galleria"),e('<div class="close-lightbox"/>').appendTo(r.$gallery).click(e.proxy(r.close,r)),r.attachKeyboard()})}},close:function(){this.$gallery.hide(),this.galleria.detachKeyboard(),this.$backdrop.hide()}},window.setProductWallHeights=t,window.lightboxPrep=n,window.lightBoxPosition=r,window.launchZoom=i,window.launchLbJsForm=s,e(document).ready(function(){e("#toggle-reviewForm").click(function(){e(this).fadeOut(100),e("#prodDtl-reviewForm-hide").show(100)}),e(document).on("click",".close-lightbox, .close-lightbox-overlay",function(){e("#lb-canvas").css("left","-3000px"),e("#lb-canvas #lb-canvas-content").html(""),e("#lb-overlay").hide(),e("#referafriend-overlay").hide(),e("#referafriend").hide()}),e.fn.clearField=function(){return this.focus(function(){this.value==this.defaultValue&&(this.value="")}).blur(function(){this.value.length||(this.value=this.defaultValue)})},e("").clearField()}),e(window).load(function(){e("ul.products-grid").length&&t()})}(jQuery),Bonobos.Inventory={categories:{},htmlLayeredNav:{},sizeFilters:[],productGroups:{},ready:!1,init:function(){this.sizeOrder={tees:["XS","S","M","L","XL","XXL"],shoes:["7","7.5","8","8w","8.5","8.5w","9","9w","9.5","9.5w","10","10w","10.5","10.5w","11","11w","11.5","11.5w","12","12w","12.5","13","13w"],pants:{waist:["28","29","30","31","32","33","34","35","36","38","40"],inseam:["30","32","34","36"]},shirts:{neck:["15.0","15.5","16.0","16.5","17.0","17.5"],sleeve:["33","34","35","36","37"]}},this.productOrder=["pants","tees","shirts","shoes"],this.htmlLayeredNav=jQuery("#layered-nav"),this.htmlSizeLabel=this.htmlLayeredNav.find(".choose-size .dd-label"),this.origSizeLabel=this.htmlSizeLabel.text(),this.presetFilters(this.getParams()),jQuery.getJSON(document.location.pathname+"/sizes.json",jQuery.proxy(this.build,this)),Bonobos.EventManager.subscribe("eSizeFilter",jQuery.proxy(this.sizeFilterChange,this))},getParams:function(){var e=window.location.search.substr(1).split("&"),t={};for(var n=0;n<e.length;n++){var r=e[n].split("=");r.length==2&&(t[r[0]]=r[1].split(","))}return t},presetFilters:function(e){if(e.f)for(var t=0;t<e.f.length;t++)jQuery(".category_filter input[value="+e.f[t]+"]").attr("checked",!0)},addProductGroup:function(e){return this.productGroups[e]||(this.productGroups[e]=new Bonobos.ProductGroup(e)),this.productGroups[e]},loaded:function(){this.ready?(this.catFilter=new Bonobos.CategoryFilter(this.htmlLayeredNav.find('[data-id="category_filter"]')),this.createSizeFilters(),this.htmlLayeredNav.find("div.choose-size").removeClass("loading"),this.htmlLayeredNav.find("div.category_filter").removeClass("loading"),jQuery("#layered-nav").find(".dropdown").dropdown()):this.ready=!0},build:function(data){var productData=eval(data),lookup={},product,category,date,group,key,groupName;for(var i=0;i<productData.length;i++){date=productData[i],this.categories[date.categoryId]||(this.categories[date.categoryId]=new Bonobos.Category(date.categoryId,"section[data-id='"+date.categoryId+"']")),category=this.categories[date.categoryId];for(var j=0;j<productData[i].items.length;j++){product=new Bonobos.Product(productData[i].items[j].parentId,productData[i].categoryId,"#product-"+productData[i].items[j].parentId),category.addProduct(product),lookup.m={},lookup.s={};for(var s=0;s<productData[i].items[j].sizes.length;s++){var size=productData[i].items[j].sizes[s];if(size.waist&&size.length&&size.length!=6&&size.length!=5){group=this.addProductGroup("pants");if(size.lengthClass==="No Inseam")for(var l=0;l<this.sizeOrder.pants.inseam.length;l++)group.addSizeMatrix(size.waist,this.sizeOrder.pants.inseam[l],product,lookup);else group.addSizeMatrix(size.waist,size.length,product,lookup)}else if(size.shirtNeck&&size.shirtSleeve)size.shirtNeck.indexOf(".")===-1&&(size.shirtNeck+=".0"),group=this.addProductGroup("shirts"),group.addSizeMatrix(size.shirtNeck,size.shirtSleeve,product,lookup);else{if(size.shirtAlpha)key=size.shirtAlpha,groupName="tees";else if(size.sweaterAlpha)key=size.sweaterAlpha,groupName="tees";else if(size.shoes)key=size.shoes,groupName="shoes";else if(size.outerwearAlpha)key=size.outerwearAlpha,groupName="tees";else if(size.outerwearNumeric)key=size.outerwearNumeric,groupName="tees";else if(size.waist)key=size.waist,groupName="pants";else{if(!size.beltNumeric)continue;key=size.beltNumeric,groupName="pants"}group=this.addProductGroup(groupName),group.addSize(key,product)}group.hasCategory()||group.addCategory(category)}}}this.loaded()},createSizeFilters:function(){var e=this.htmlLayeredNav.find("div.dd-options-inner"),t,n;for(var r=0;r<this.productOrder.length;r++)n=this.productOrder[r],this.productGroups.hasOwnProperty(n)&&(t=jQuery(_.template(JST["templates/categories/size_"+n],{model:this.productGroups[n],sizeIndex:this.sizeOrder[n]})),e.after(t),e=t,this.sizeFilters.push(new Bonobos.SizeFilterGroup(t)));t&&t.addClass("last-child")},getCategory:function(e){return this.categories[e]},sizeFilterChange:function(e){var t=0,n;for(var r=0;r<this.sizeFilters.length;r++)n=this.sizeFilters[r],n.isActive()&&++t,n.wasChanged()&&(n.setChanged(!1),this.filter(this.productGroups[n.prodGroup],n),this.render(this.productGroups[n.prodGroup].getCategories()));t===0?this.htmlSizeLabel.text(this.origSizeLabel):this.sizeFilters.length===1?this.htmlSizeLabel.text(this.sizeFilters[0].getLabel()):this.htmlSizeLabel.text("In my sizes")},filter:function(e,t){var n=t.activeFilters;if(n.mainCount==0&&n.subCount==0){var r=e.getCategories();for(var i in r){var s=r[i].getProducts();for(var o=0;o<s.length;o++)s[o].setVisible(!0)}}else if(n.subCount==0)for(var u in n.main)this.preRender(e.getSizes(u,null));else if(n.mainCount==0)for(var u in n.sub)this.preRender(e.getSizes(null,u));else for(var a in n.main)for(var f in n.sub)this.preRender(e.getSizes(a,f))},preRender:function(e){if(e)for(var t=0;t<e.length;t++)e[t].isVisible()||e[t].setVisible(!0)},render:function(e){var t,n=this.catFilter.activeFilters.count==0;for(var r in e){var i=e[r],s=i.getProducts(),o=!0,u=[];for(var a=0;a<s.length;a++)t=s[a],t.isVisible()?(t.getHtmlElem().hasClass("hide")&&u.push(t),t.setVisible(!1),o=!1):t.getHtmlElem().hasClass("hide")||u.push(t);o&&(i.setHidden(!0),i.getHtmlElem().hasClass("hide")||i.hide());for(var a=0;a<u.length;a++)t=u[a],console.log("yo"),console.log(t.getHtmlElem()),t.getHtmlElem().hasClass("hide")?(t.getHtmlElem().removeClass("hide"),t.getHtmlElem().closest("span").replaceWith(function(){return jQuery(this).find("li")})):(t.getHtmlElem().addClass("hide"),t.getHtmlElem().replaceWith(function(){return"<span class='hide'>"+this.outerHTML+"</span>"}));o||(i.setHidden(!1),(i.isFilterSet()||n)&&i.show())}}},Bonobos.ProductGroup=function(e){var e=e,t={},n={main:{},sub:{}};this.getName=function(){return e},this.getCategories=function(){return t},this.addCategory=function(e){t[e.getId()]=e},this.hasCategory=function(e){return t.hasOwnProperty(e)},this.getSizes=function(e,t){return e&&t?n[e][t]:e?n.main[e]:t?n.sub[t]:null},this.getRawSizes=function(){return n},this.addSize=function(e,t){n.main[e]||(n.main[e]=[]),n.main[e].push(t)},this.addSizeMatrix=function(e,t,r,i){n[e]||(n[e]={}),n[e][t]||(n[e][t]=[]),n[e][t].push(r),n.main[e]||(n.main[e]=[]),n.sub[t]||(n.sub[t]=[]),i.m[e]||(n.main[e].push(r),i.m[e]=!0),i.s[t]||(n.sub[t].push(r),i.s[t]=!0)}},Bonobos.Category=function(e,t){var n=!1,r="",i=[],s=!1;this.getId=function(){return e},this.isFilterSet=function(){return n},this.setFilter=function(e){n=e},this.getProducts=function(){return i},this.addProduct=function(e){i.push(e)},this.getHtmlElem=function(){return jQuery(t)},this.getName=function(){return r},this.setName=function(e){r=e},this.isHidden=function(){return s},this.setHidden=function(e){s=e},this.hide=function(){jQuery(t).addClass("hide")},this.show=function(){jQuery(t).removeClass("hide")}},Bonobos.Product=function(e,t,n){var r=e,t=t,n=n,i=!1,s=jQuery(n).html();this.getProdId=function(){return r},this.getSubCatId=function(){return t},this.isVisible=function(){return i},this.setVisible=function(e){i=e},this.getHtmlElem=function(){return jQuery(n)},this.innerHtml=function(){return s}},Bonobos.SizeFilter=function(e,t){var n=jQuery(e).text(),r=!1,i=!1,t=t;jQuery(e).data("filter",this),this.getId=function(){return n},this.isActivated=function(){return r},this.isDisabled=function(){return i},this.isMain=function(){return t},this.activate=function(){r=!0,jQuery(e).addClass("selected")},this.deactivate=function(){r=!1,jQuery(e).removeClass("selected")},this.enable=function(){i=!1,jQuery(e).removeClass("disabled")},this.disable=function(){i=!0,jQuery(e).addClass("disabled")}},Bonobos.SizeFilterGroup=function(e){this.htmlSizeType=e,this.prodGroup=jQuery(this.htmlSizeType).attr("data-id"),this.activeFilters={main:{},mainCount:0,sub:{},subCount:0};var t,n;this.htmlSizeType.find(".main-options a").each(function(){n=jQuery(this),n.filter=new Bonobos.SizeFilter(this,!0)}).on("click",jQuery.proxy(this.filterChanged,this)),this.htmlSizeType.find(".suboptions a").each(function(){n=jQuery(this),n.filter=new Bonobos.SizeFilter(this,!1)}).on("click",jQuery.proxy(this.filterChanged,this)),this.isActive=function(){return this.activeFilters.mainCount||this.activeFilters.subCount},this.getLabel=function(){var e="In ";if(this.activeFilters.mainCount&&this.activeFilters.subCount&&this.activeFilters.mainCount+this.activeFilters.subCount<4){var t=0,n=0;for(var r in this.activeFilters.main){for(var i in this.activeFilters.sub){e+=r+"x"+i;if(t<this.activeFilters.mainCount-1||n<this.activeFilters.subCount-1)e+=" and ";++n}++t}}else if(this.activeFilters.mainCount>0&&this.activeFilters.mainCount<3&&!this.activeFilters.subCount){var s=1;for(var o in this.activeFilters.main){if(s!==1){e+=" and "+o;break}e+=o,++s}}else if(this.activeFilters.subCount>0&&this.activeFilters.subCount<3&&!this.activeFilters.mainCount){var s=1;for(var o in this.activeFilters.sub){if(s!==1){e+=" and "+o;break}e+=o,++s}}else e+="multiple sizes";return e},this.wasChanged=function(){return t},this.setChanged=function(e){t=e}},Bonobos.SizeFilterGroup.prototype.filterChanged=function(e){e.preventDefault(),this.setChanged(!0);var t=jQuery(e.target).data("filter");t.isActivated()?(t.deactivate(),t.isMain()?(delete this.activeFilters.main[t.getId()],--this.activeFilters.mainCount):(delete this.activeFilters.sub[t.getId()],--this.activeFilters.subCount)):(t.activate(),t.isMain()?(this.activeFilters.main[t.getId()]=t,++this.activeFilters.mainCount):(this.activeFilters.sub[t.getId()]=t,++this.activeFilters.subCount)),Bonobos.EventManager.publish("eSizeFilter")},Bonobos.CategoryFilter=function(e){this.layeredNav=e,this.htmlLabel=this.layeredNav.find(".dd-label"),this.origLabel=this.htmlLabel.text(),this.activeFilters={count:0,map:{}};var t,n,r=jQuery(".dd-options li"),i;for(var s=0;s<r.length;s++)i=jQuery(r[s]),t=i.attr("data-id"),n=Bonobos.Inventory.getCategory(t),n&&n.setName(i.text()),i.find("input").is(":checked")&&this.toggleFilter(t),i.on("click","input",jQuery.proxy(this.triggerFilter,this))},Bonobos.CategoryFilter.prototype.hideAllExcept=function(e){for(var t in Bonobos.Inventory.categories)Bonobos.Inventory.categories.hasOwnProperty(t)&&t!=e&&Bonobos.Inventory.categories[t].hide()},Bonobos.CategoryFilter.prototype.showAll=function(){var e;for(var t in Bonobos.Inventory.categories)Bonobos.Inventory.categories.hasOwnProperty(t)&&(e=Bonobos.Inventory.getCategory(t),e.isHidden()||e.show())},Bonobos.CategoryFilter.prototype.toggleFilter=function(e){var t=Bonobos.Inventory.getCategory(e);if(!t)return;var n=this.activeFilters.count;t.isFilterSet()?(t.setFilter(!1),--this.activeFilters.count,delete this.activeFilters.map[e]):(t.setFilter(!0),++this.activeFilters.count,this.activeFilters.map[e]=t);if(n===0&&this.activeFilters.count===1)this.hideAllExcept(e),this.htmlLabel.text(t.getName());else if(this.activeFilters.count===0)this.showAll(),this.htmlLabel.text(this.origLabel);else if(t.isFilterSet())t.isHidden()||t.show(),this.activeFilters.count===2&&this.htmlLabel.text(this.htmlLabel.text()+" and ...");else{t.hide();if(this.activeFilters.count===1)for(var r in this.activeFilters.map)this.htmlLabel.text(this.activeFilters.map[r].getName())}},Bonobos.CategoryFilter.prototype.triggerFilter=function(e){var t=jQuery(e.target).val();this.toggleFilter(t)},Bonobos.EventManager={subscribe:function(e,t){jQuery(this).bind(e,t)},publish:function(e){jQuery(this).trigger(e)}},function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Bonobos.Models.Product=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={price:0},n.prototype.initialize=function(e){var t=this;e==null&&(e={});if(e.configurations)return this.configurations=_(e.configurations).map(function(e){return new Bonobos.Collections.ProductConfigurations(e,{product_id:t.get("id")})})},n.prototype.inStock=function(){return _(this.configurations).all(function(e){return e.inStock()})},n.prototype.url="/",n}(Bonobos.Models.Base)}.call(this),function(){Bonobos.Models.SubCategory=Backbone.Model.extend({initialize:function(){var e;return(e=this.products)!=null?e:this.products=new Bonobos.Collections.Products},parse:function(e){var t;return(t=this.products)==null&&(this.products=new Bonobos.Collections.Products),this.products.model=Bonobos.Models.Product,_.isEmpty(e.products)||this.products.add(e.products),e},url:"/user"})}.call(this),function(){Bonobos.Collections.Products=Backbone.Collection.extend({url:"/",model:Bonobos.Models.Product,comparator:function(e){return e.get("position")}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Bonobos.Collections.ProductConfigurations=function(t){function r(){return this.onChangeSelection=e(this.onChangeSelection,this),this.initialize=e(this.initialize,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.model=Bonobos.Models.ProductConfiguration,r.prototype.initialize=function(e,t){var n=this;return t==null&&(t={}),this.optionsByName={},this.product_id=t.product_id,e&&(_.each(e,function(e,t){var r,i,s,o,u;if(e.configuration){o=_(e.configuration).keys(),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],n.optionsByName[r]||(n.optionsByName[r]=new Bonobos.Collections.ProductConfigurableOptions([],{productId:n.product_id,configurableName:r}),n.optionsByName[r].on("change:selected",n.onChangeSelection)),u.push(n.optionsByName[r].addConfiguration(e));return u}return n.simple=!0,n.in_stock=e.in_stock,n.sku=e.sku}),_.defer(function(){var e,t;t=[];for(e in n.optionsByName)t.push(n.optionsByName[e].forEach(function(e){return e.readSelected()}));return t})),r.__super__.initialize.apply(this,arguments)},r.prototype.optionNames=function(){var e;return e=this.at(0),e?_(e.get("configuration")||{}).keys():[]},r.prototype.addFilter=function(e,t){var n=this;return _(this.getOtherNames(e)).each(function(r){var i;return i=n.optionsFor(r),i.addFilter(e,t)})},r.prototype.removeFilter=function(e,t){var n=this;return _(this.getOtherNames(e)).each(function(t){var r;return r=n.optionsFor(t),r.removeFilter(e)})},r.prototype.onChangeSelection=function(e,t){return t?this.addFilter(e.collection.configurableName,e.get("optionName")):this.removeFilter(e.collection.configurableName,e.get("optionName")),this.trigger("change:selected",this.selectedProductId())},r.prototype.getOtherNames=function(e){return _(this.optionNames()).without(e)},r.prototype.optionsFor=function(e){return this.optionsByName[e]},r.prototype.allSelected=function(){var e=this;return _(this.optionNames()).all(function(t){return e.optionsByName[t].selected()})},r.prototype.inStock=function(){return this.simple?this.in_stock:this.any(function(e){return e.get("in_stock")})},r.prototype.valid=function(){return this.simple?this.in_stock:this.allSelected()},r.prototype.selectedOptions=function(){var e=this;return _(this.optionsByName).chain().keys().map(function(t){if(e.optionsByName[t].selected())return e.optionsByName[t].selected()}).compact().value()},r.prototype.selectedProductId=function(){var e,t,n;this.simple?this.in_stock&&(n=this.product_id):this.allSelected()?(t={},_(this.selectedOptions()).each(function(e){return t[e.get("configurableName")]=e.get("optionName")}),e=_(this.selectedOptions()[0].configurations).find(function(e){return _(e.get("configuration")).isEqual(t)}),n=e.get("sku")):void 0;if(n)return parseInt(n,10)},r.prototype.cartItem=function(){return new Bonobos.Models.CartItem({product_id:this.selectedProductId(),quantity:1})},r}(Bonobos.Collections.Base)}.call(this),function(){Bonobos.Collections.SubCategories=Backbone.Collection.extend({model:Bonobos.Models.SubCategory,parse:function(e){return e.sub_categories},comparator:function(e){return e.get("position")}})}.call(this),function(){Bonobos.Views.ShowCategory=Backbone.View.extend({initialize:function(e){return _.bindAll(this,"addSubCategory"),this.render()},render:function(){return this.category=document.location.pathname,this.category=this.category.substr(this.category.lastIndexOf("/")+1),jQuery("ul.products-list").html(""),this.collection.each(this.addSubCategory),this},addSubCategory:function(e){var t,n,r=this;return e.products.length>0&&(jQuery("ul.products-list").append(_.template(JST["templates/categories/subcategory"],{model:e})),t="",n=0,e.products.each(function(e){var i;return i=e.get("url"),t+=_.template(JST["templates/categories/product_preview"],{model:e,category:r.category,url:i,index:n}),n++}),jQuery("section[data-id='"+e.id+"']").append(t)),this}})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/product_preview"]="<li itemscope itemtype='http://schema.org/Product' class='item' id='product-<%= model.get('entity_id') %>'>    <a itemprop='url' href='<%= url %>        '>        <img itemprop='image' src='http://static<%= index % 8 + 1 %>.bonobos.com/media/catalog/product<%= model.get('thumbnail') %>' alt='<%= model.get('name') %>'/>        <div class='product-summary-container'>          <h3 itemprop='name' class='product-name a-center'><%= model.get('name') %></h3>          <% if (model.get('pants_finish_value')) { %>            <h4 class='a-center'><%= model.get('pants_finish_value') %></h4>          <% } %>          <h6 itemprop='description' class='short-description'><%= model.get('short_description') %></h6>          <p itemscope itemtype='http://schema.org/Offer' itemprop='offers' class='price-box'>            <span class='configurable-price-from-label'></span>            <% if (model.get('special_price')) { %>              <span class='price original'>$<%= model.get('price').toFixed(2) %></span>              <span class='price sale'>                <span class='price-label'>Sale:</span>                <span itemprop='price' class='price'>$<%= model.get('special_price').toFixed(2) %></span>              </span>            <% } else { %>              <span itemprop='price' class='price'>$<%= model.get('price').toFixed(2) %></span>            <% } %>          </p>        </div>    </a>  </li>"}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/size_pants"]='<div class="size-type pants_size_numeric_combined_filter" data-id="pants">    <div class="size-disabled-block"></div>    <i></i>    <label class="filter-label">Pants</label>    <div class="main-options clearfix">      <label>Waist</label>      <% var sizes = model.getRawSizes() %>      <% for (var i=0; i<sizeIndex.waist.length; i++) { %>        <% if (sizes.main.hasOwnProperty(sizeIndex.waist[i])) { %>          <a href="#" class="option"><%= sizeIndex.waist[i] %></a>        <% } %>      <% } %>    </div>    <% if (!jQuery.isEmptyObject(sizes.sub)) { %>    <div class="suboptions clearfix">      <label>Inseam</label>      <% for (var i=0; i<sizeIndex.inseam.length; i++) { %>        <% if (sizes.sub.hasOwnProperty(sizeIndex.inseam[i])) { %>          <a href="#" class="option"><%= sizeIndex.inseam[i] %></a>        <% } %>      <% } %>    </div>    <% } %>  </div>'}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/size_shirts"]='<div class="size-type shirts_size_numeric_us_combined_filter" data-id="shirts">    <div class="size-disabled-block"></div>    <i></i>    <label class="filter-label">Dress Shirts</label>    <div class="main-options clearfix">      <label>Neck</label>      <% var sizes = model.getRawSizes() %>      <% for (var i=0; i<sizeIndex.neck.length; i++) { %>        <% if (sizes.main.hasOwnProperty(sizeIndex.neck[i])) { %>          <a href="#" class="option"><%= sizeIndex.neck[i] %></a>        <% } %>      <% } %>    </div>    <div class="suboptions clearfix">      <label>Sleeve</label>      <% for (var i=0; i<sizeIndex.sleeve.length; i++) { %>        <% if (sizes.sub.hasOwnProperty(sizeIndex.sleeve[i])) { %>          <a href="#" class="option"><%= sizeIndex.sleeve[i] %></a>        <% } %>      <% } %>    </div>  </div>'}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/size_shoes"]='<div class="size-type shoes_size_us_filter" data-id="shoes">    <div class="size-disabled-block"></div>    <i></i>    <label class="filter-label">Shoes</label>    <div class="main-options clearfix">    <% var prodSizes = model.getRawSizes() %>    <% for (var i=0; i<sizeIndex.length; i++) { %>      <% if (prodSizes.main.hasOwnProperty(sizeIndex[i])) { %>        <a href="#" class="option"><%= sizeIndex[i] %></a>      <% } %>    <% } %>  </div>'}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/size_tees"]='<div class="size-type shirts_size_alpha_filter" data-id="tees">    <div class="size-disabled-block"></div>    <i></i>    <label class="filter-label">Shirts</label>    <div class="main-options clearfix">      <% var prodSizes = model.getRawSizes() %>      <% for (var i=0; i<sizeIndex.length; i++) { %>        <% if (prodSizes.main.hasOwnProperty(sizeIndex[i])) { %>          <a href="#" class="option"><%= sizeIndex[i] %></a>        <% } %>      <% } %>    </div>  </div>'}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/categories/subcategory"]="<section class='category-products' data-id='<%= model.id %>'>    <header class='text-center'>      <h2><%= model.get('name') %></h2>      <% if(model.get('sub_header')) { %>        <h4><%= model.get('sub_header') %></h4>      <% } %>    </header>  </section>"}.call(this),function(){$(document).ready(function(){var e;if(jQuery("body#categories-show-page").length)return Bonobos.collections.sub_categories=new Bonobos.Collections.SubCategories,e=document.location.pathname,e.substr(-1)==="/"&&(e=e.substr(0,e.length-1)),Bonobos.collections.sub_categories.url=e+".json",Bonobos.collections.sub_categories.fetch({success:function(e){return new Bonobos.Views.ShowCategory({collection:Bonobos.collections.sub_categories,el:jQuery("ul.products-list")}),Bonobos.Inventory.loaded()},error:function(e){}}),Bonobos.Inventory.init()})}.call(this);